# Архитектура системы

## Общие положения

Глобально архитектуру системы можно разделить на 4 уровня:

- Фронтенд (веб интерфейс)
- Бэкенд (веб сервер на Raspberry Pi)
- Модули (универсальные модули на базе ESP8266)
- Устройства (испольнительные устройства и датчики)

Более нижний уровень является интерфейсом для более верхнего, внося очередной слой абстракции. Взаимодействие через один слой (не по порядку) исключается.

Далее в этом документе будет более подробно описана реализация каждого из уровней.

## Уровни

### Фронтенд

- Будет реализован в формате spa приложения на Rest + ts. 
- За разадачу статического контента будет отвечать веб сервер Nginx
- В качестве хостинга для фронтэнда также будет использованна Raspberry Pi
- Запросы к бэкэнду будет осуществлятся в рамках стандартного REST API по протоколу HTTP

### Бэкенд

- Будет реализован на Spring MVC + Boot
- При реализации будет использована старндартная слоистая архитектура
- Для обеспечения уровня хранения данных будет использована база данных SQLite
- Взаимодействие с фронтендом и модулями будет осуществлятеся в рамках стандартного REST API по протоколу HTTP

### Moдули

- Каждый модель будет представлять из себя законченное устройство в корпусе и состоять из следующих компонентов:
    - WEMOS D1 MINI на базе ESP8266
    - Модуль MOS транзиторов
    - Клемники
    - Модуль powerbank (котроль заряда + преобразовате на 5V)
    - Аккамулятор LiPo
- [Принципиальная схема модуля](/resource/module-scheme.pdf)
- Модули подчиняются rest запросам по [спецификации](/resource/openapi.yaml) (посмотреть можно [здесь](https://editor.swagger.io/))

### Устройства

- Выделяется два типа внешних устройств: датчики и исполнительные устройства
- Управление исполнительными устройствами осуществляется чрез подключение их в разрыв цепи через транзистор
- При использовании исполнительных устройств 
- Датчики подразделяются на аналоговые и цифровые
- Список поддерживаемых устройств зафиксирован в прошивке модуля
